# User Activity Checker

This tool analyzes Cascade usage data to determine which users have been active within a specified time period (default: past 30 days).

## Overview

The `check_user_activity.py` script works with the raw API responses generated by `cascade_usage_analyzer.py` to:

1. Identify which users have used Cascade within the specified time period
2. Generate a report of active and inactive users
3. Calculate how long it has been since each user's last activity

## Workflow and Prerequisites

This tool is part of a larger analytics workflow and requires output from other scripts:

1. First, run `AnalyticScripts.email_api_mapping` to get email-to-API-key mappings
   - Generates: `email_api_mapping_YYYY-MM-DD.json`

2. Then, run `AnalyticScripts.cascade_usage_analyzer` to collect usage data
   - Generates: `cascade_api_raw_responses_YYYY-MM-DD.json`

3. Finally, run this script to identify active and inactive users
   - Generates: `user_activity_report_YYYY-MM-DD.json`

All output files are stored in the project's `output` directory.

## Usage

```bash
python check_user_activity.py [options]
```

### Options

- `--days DAYS`: Number of days to check for activity (default: 30)
- `--raw-file FILE`: Path to raw API responses JSON file (default: most recent `cascade_api_raw_responses_*.json`)
- `--email-map FILE`: Path to email-to-API-key mapping JSON file
- `--output FILE`: Output file for detailed report in JSON format (default: `user_activity_report_YYYY-MM-DD.json`)
- `--directory DIR`: Directory to search for files (default: current directory)

### Example

```bash
# Check for activity in the past 14 days
python check_user_activity.py --days 14

# Specify input file manually
python check_user_activity.py --raw-file cascade_api_raw_responses_2025-09-15.json

# Use a specific email-to-API-key mapping file
python check_user_activity.py --email-map /path/to/email_api_mapping_2025-09-15.json

# Specify output file
python check_user_activity.py --output team_activity_report.json
```

## Output

The script generates:

1. A console report showing:
   - Total count of active and inactive users
   - List of active users with their last activity date
   - List of inactive users with their last activity date or "Never active"

2. A JSON file containing detailed information about:
   - Active users (used Cascade within the specified time period)
   - Inactive users (haven't used Cascade within the specified time period)
   - Last active date for each user
   - Days since last activity

## Dependencies

- Python 3.6+
- Standard libraries: os, csv, json, argparse, datetime, collections, pathlib

## Input and Output Files

### Input Files

- `cascade_api_raw_responses_YYYY-MM-DD.json`: Raw API responses containing detailed usage data
- `email_api_mapping_YYYY-MM-DD.json`: Mapping of email addresses to API keys

The script will automatically find and use the most recent versions of these files if they exist in the output directory.

### Output Files

- `user_activity_report_YYYY-MM-DD.json`: Detailed report of active and inactive users

## Use Cases

- Identify inactive users for account cleanup
- Monitor user engagement over time
- Generate reports on active user counts
- Identify users who may need additional support or training
